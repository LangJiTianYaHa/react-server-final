(this["webpackJsonpreact-admin-client"]=this["webpackJsonpreact-admin-client"]||[]).push([[0],{352:function(e,t,n){},494:function(e,t,n){},495:function(e,t,n){},501:function(e,t,n){},506:function(e,t,n){},689:function(e,t,n){},701:function(e,t,n){},702:function(e,t,n){},703:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(9),c=n.n(s),i=n(125),o=n(310),u=n(311),l=n(48),d=n(176),p=n.n(d),h="user_key",j=function(e){p.a.set(h,e)},b=function(){p.a.remove(h)},f="set_head_title",m="receive_user",O="show_error_msg",g="reset_user";var x=function(){return p.a.get(h)||{}}();var v=Object(i.combineReducers)({headTitle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t.type===f?t.data:e},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return t.user;case O:var n=t.errorMsg;return Object(l.a)(Object(l.a)({},e),{},{errorMsg:n});case g:return{};default:return e}}}),y=Object(i.createStore)(v,Object(o.composeWithDevTools)(Object(i.applyMiddleware)(u.a))),w=n(18),k=n(19),S=n(21),C=n(20),N=n(79),I=n(42),_=(n(66),n(26)),A=(n(100),n(35)),P=(n(82),n(39)),T=(n(101),n(7)),U=n(22),F=n.n(U),M=n(32),E=(n(352),n.p+"static/media/logo.f6487143.png"),D=n(55),R=(n(83),n(34)),V=n(165),W=n(313),z=n.n(W),L=n(221),K=n.n(L);function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(a,r){("GET"===n?K.a.get(e,{params:t}):K.a.post(e,t)).then((function(e){a(e.data)})).catch((function(e){R.a.error("\u8bf7\u6c42\u51fa\u9519\u4e86\uff01"+e.message)}))}))}var H=function(e,t){return q("api/login",{username:e,password:t},"POST")},B=function(e){return q("api/manage/category/list",{parentId:e})},J=function(e,t){return q("api/manage/category/add",{categoryName:e,parentId:t},"POST")},Z=function(e){return q("api/manage/category/update",{categoryId:e.categoryId,categoryName:e.categoryName},"POST")},$=function(e,t){return q("api/manage/product/list",{pageNum:e,pageSize:t})},G=function(e){var t=e.pageNum,n=e.pageSize,a=e.searchName,r=e.searchType;return q("api/manage/product/search",Object(V.a)({pageNum:t,pageSize:n},r,a))},Q=function(e){return q("api/manage/category/info",{categoryId:e})},X=function(e,t){return q("api/manage/product/updateStatus",{productId:e,status:t},"POST")},Y=function(e){return q("api/manage/img/delete",{name:e},"POST")},ee=function(e){return q("api/manage/product/"+(e._id?"update":"add"),e,"POST")},te=function(e){return q("api/manage/role/add",{roleName:e},"POST")},ne=function(e){return q("api/manage/role/update",e,"POST")},ae=function(){return q("api/manage/user/list")},re=function(e){return q("api/manage/user/delete",{userId:e},"POST")},se=function(e){return q("api/manage/user/"+(e._id?"update":"add"),e,"POST")},ce=function(e){return new Promise((function(t,n){var a="http://api.map.baidu.com/telematics/v3/weather?location=".concat(e,"&output=json&ak=3p49MVra6urFRGOT9s8UBWr2");z()(a,{},(function(e,n){if(console.log("jsonp()",e,n),e||"success"!==n.status)R.a.error("\u83b7\u53d6\u5929\u6c14\u4fe1\u606f\u5931\u8d25!");else{var a=n.results[0].weather_data[0],r=a.dayPictureUrl,s=a.weather;t({dayPictureUrl:r,weather:s})}}))}))},ie=function(e){return{type:f,data:e}},oe=function(e){return{type:m,user:e}},ue=function(){return b(),R.a.success("\u9000\u51fa\u767b\u5f55\u6210\u529f"),{type:g}},le=n(3),de=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleSubmit=function(t){t.preventDefault(),e.props.form.validateFields(function(){var t=Object(M.a)(F.a.mark((function t(n,a){var r,s;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n?console.log("\u6821\u9a8c\u5931\u8d25\uff01"):(r=a.username,s=a.password,e.props.login(r,s));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},e.validatePwd=function(e,t,n){console.log("validatePwd:",e,t,n),""===t?n("\u5bc6\u7801\u5fc5\u987b\u8f93\u5165"):t.length<4?n("\u5bc6\u7801\u5fc5\u987b\u4e0d\u80fd\u5c0f\u4e8e4\u4f4d"):t.length>12?n("\u5bc6\u7801\u5fc5\u987b\u4e0d\u80fd\u5927\u4e8e12\u4f4d"):/^[a-zA-Z0-9_]+$/.test(t)?n():n("\u5bc6\u7801\u5fc5\u987b\u4e3a\u82f1\u6587\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210")},e}return Object(k.a)(n,[{key:"render",value:function(){var e=this.props.user;if(e&&e._id)return Object(le.jsx)(I.a,{to:"/home"});var t=this.props.form.getFieldDecorator;return Object(le.jsxs)("div",{className:"login",children:[Object(le.jsxs)("header",{className:"login-header",children:[Object(le.jsx)("img",{src:E,alt:"logo"}),Object(le.jsx)("h1",{children:"React\u9879\u76ee\uff1a\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf"})]}),Object(le.jsxs)("section",{className:"login-content",children:[Object(le.jsx)("div",{className:e.errorMsg?"error-msg show":"error-msg",children:e.errorMsg}),Object(le.jsx)("h2",{children:"\u7528\u6237\u767b\u9646"}),Object(le.jsxs)(A.a,{onSubmit:this.handleSubmit,className:"login-form",children:[Object(le.jsx)(A.a.Item,{children:t("username",{rules:[{required:!0,whitespace:!0,message:"\u7528\u6237\u540d\u5fc5\u987b\u8f93\u5165"},{min:4,message:"\u7528\u6237\u540d\u5fc5\u987b\u5927\u4e8e4\u4f4d"},{max:12,message:"\u7528\u6237\u540d\u5fc5\u987b\u5c0f\u4e8e12\u4f4d"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u4e3a\u82f1\u6587\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210"}],initialValue:"admin"})(Object(le.jsx)(P.a,{prefix:Object(le.jsx)(T.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u7528\u6237\u540d",autoComplete:"off"}))}),Object(le.jsx)(A.a.Item,{children:t("password",{rules:[{validator:this.validatePwd}]})(Object(le.jsx)(P.a,{prefix:Object(le.jsx)(T.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"\u5bc6\u7801"}))}),Object(le.jsx)(A.a.Item,{children:Object(le.jsx)(_.a,{type:"primary",htmlType:"submit",className:"login-form-button",children:"\u767b\u9646"})})]})]})]})}}]),n}(a.Component),pe=A.a.create()(de),he=Object(D.b)((function(e){return{user:e.user}}),{login:function(e,t){return function(){var n=Object(M.a)(F.a.mark((function n(a){var r,s,c;return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,H(e,t);case 2:0===(r=n.sent).status?(s=r.data,j(s),a(oe(s)),R.a.success("\u767b\u9646\u6210\u529f")):(c=r.msg,a({type:O,errorMsg:c}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}})(pe),je=(n(491),n(128)),be=(n(134),n(62));n(494);function fe(e){return Object(le.jsx)("button",Object(l.a)(Object(l.a)({},e),{},{className:"link-button"}))}var me=[{title:"\u9996\u9875",key:"/home",icon:"home",isPublic:!0},{title:"\u5546\u54c1",key:"/products",icon:"appstore",children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category",icon:"bars"},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product",icon:"tool"}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user",icon:"user"},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role",icon:"safety"},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",icon:"area-chart",children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar",icon:"bar-chart"},{title:"\u6298\u7ebf\u56fe",key:"/charts/line",icon:"line-chart"},{title:"\u997c\u56fe",key:"/charts/pie",icon:"pie-chart"}]},{title:"\u8ba2\u5355\u7ba1\u7406",key:"/order",icon:"windows"}];function Oe(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}n(495);var ge=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={currentTime:Oe(Date.now()),dayPictureUrl:"",weather:""},e.getTime=function(){e.intervalId=setInterval((function(){var t=Oe(Date.now());e.setState({currentTime:t})}),1e3)},e.getWeather=Object(M.a)(F.a.mark((function t(){var n,a,r;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ce("\u5317\u4eac");case 2:n=t.sent,a=n.dayPictureUrl,r=n.weather,e.setState({dayPictureUrl:a,weather:r});case 6:case"end":return t.stop()}}),t)}))),e.getTitle=function(){var t,n=e.props.location.pathname;return me.forEach((function(e){if(e.key===n)t=e.title;else if(e.children){var a=e.children.find((function(e){return 0===n.indexOf(e.key)}));a&&(t=a.title)}})),t},e.logout=function(){(0,be.a.confirm)({content:"\u786e\u5b9a\u9000\u51fa\u5417\uff1f",onOk:function(){e.props.logout()}})},e}return Object(k.a)(n,[{key:"componentDidMount",value:function(){this.getTime(),this.getWeather()}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this.state,t=e.currentTime,n=e.dayPictureUrl,a=e.weather,r=this.props.user.username,s=this.props.headTitle;return Object(le.jsxs)("div",{className:"header",children:[Object(le.jsxs)("div",{className:"header-top",children:[Object(le.jsxs)("span",{children:["\u6b22\u8fce\uff0c",r]}),Object(le.jsx)(fe,{onClick:this.logout,children:"\u9000\u51fa"})]}),Object(le.jsxs)("div",{className:"header-bottom",children:[Object(le.jsx)("div",{className:"header-bottom-left",children:s}),Object(le.jsxs)("div",{className:"header-bottom-right",children:[Object(le.jsx)("span",{children:t}),Object(le.jsx)("img",{src:n,alt:"weather"}),Object(le.jsx)("span",{children:a})]})]})]})}}]),n}(a.Component),xe=Object(D.b)((function(e){return{headTitle:e.headTitle,user:e.user}}),{logout:ue})(Object(I.g)(ge)),ve=(n(498),n(98)),ye=(n(501),ve.b.SubMenu),we=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).hasAuth=function(t){var n=t.key,a=t.isPublic,r=e.props.user.role.menus;return!("admin"!==e.props.user.username&&!a&&-1===r.indexOf(n))||!!t.children&&!!t.children.find((function(e){return-1!==r.indexOf(e.key)}))},e.getMenuNodes_map=function(t){return t.map((function(t){return t.children?Object(le.jsx)(ye,{title:Object(le.jsxs)("span",{children:[Object(le.jsx)(T.a,{type:t.icon}),Object(le.jsxs)("span",{children:[t.title," "]})]}),children:e.getMenuNodes(t.children)},t.key):Object(le.jsx)(ve.b.Item,{children:Object(le.jsxs)(N.b,{to:t.key,children:[Object(le.jsx)(T.a,{type:t.icon}),Object(le.jsxs)("span",{children:[t.title," "]})]})},t.key)}))},e.getMenuNodes=function(t){var n=e.props.location.pathname;return t.reduce((function(t,a){e.hasAuth(a)&&(a.children?(a.children.find((function(e){return 0===n.indexOf(e.key)}))&&(e.openKey=a.key),t.push(Object(le.jsx)(ye,{title:Object(le.jsxs)("span",{children:[Object(le.jsx)(T.a,{type:a.icon}),Object(le.jsxs)("span",{children:[a.title," "]})]}),children:e.getMenuNodes(a.children)},a.key))):(a.key!==n&&0!==n.indexOf(a.key)||e.props.setHeadTitle(a.title),t.push(Object(le.jsx)(ve.b.Item,{children:Object(le.jsxs)(N.b,{to:a.key,onClick:function(){return e.props.setHeadTitle(a.title)},children:[Object(le.jsx)(T.a,{type:a.icon}),Object(le.jsxs)("span",{children:[a.title," "]})]})},a.key))));return t}),[])},e}return Object(k.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.memuNodes=this.getMenuNodes(me)}},{key:"render",value:function(){var e=this.props.location.pathname;console.log(e),0===e.indexOf("/product")&&(e="/product");var t=this.openKey;return Object(le.jsxs)("div",{className:"left-nav",children:[Object(le.jsxs)(N.b,{to:"/",className:"left-nav-header",children:[Object(le.jsx)("img",{src:E,alt:"logo"}),Object(le.jsx)("h1",{children:"\u7845\u8c37\u540e\u53f0"})]}),Object(le.jsx)(ve.b,{mode:"inline",theme:"dark",selectedKeys:[e],defaultOpenKeys:[t],children:this.memuNodes})]})}}]),n}(a.Component),ke=Object(D.b)((function(e){return{user:e.user}}),{setHeadTitle:ie})(Object(I.g)(we)),Se=(n(506),function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"render",value:function(){return Object(le.jsx)("div",{className:"home",children:"\u6b22\u8fce\u4f7f\u7528\u7845\u8c37\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf"})}}]),n}(a.Component)),Ce=(n(86),n(43)),Ne=(n(163),n(93)),Ie=(n(158),n(56)),_e=A.a.Item,Ae=Ie.a.Option,Pe=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props,n=t.categorys,a=t.parentId;return Object(le.jsxs)(A.a,{children:[Object(le.jsx)(_e,{children:e("parentId",{initialValue:a})(Object(le.jsxs)(Ie.a,{children:[Object(le.jsx)(Ae,{value:"0",children:"\u4e00\u7ea7\u5206\u7c7b"}),n.map((function(e){return Object(le.jsx)(Ae,{value:e._id,children:e.name})}))]}))}),Object(le.jsx)(_e,{children:e("categoryName",{initialValue:"",rules:[{required:!0,message:"\u5206\u7c7b\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(Object(le.jsx)(P.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))})]})}}]),n}(a.Component),Te=A.a.create()(Pe),Ue=A.a.Item,Fe=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.categoryName,t=this.props.form.getFieldDecorator;return Object(le.jsx)(A.a,{children:Object(le.jsx)(Ue,{children:t("categoryName",{initialValue:e,rules:[{required:!0,message:"\u5206\u7c7b\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(Object(le.jsx)(P.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))})})}}]),n}(a.Component),Me=A.a.create()(Fe),Ee=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={categorys:[],loading:!1,parentId:"0",parentName:"",subCategorys:[],showStatus:0},e.initColumns=function(){e.columns=[{title:"\u5206\u7c7b\u7684\u540d\u79f0",dataIndex:"name"},{title:"\u64cd\u4f5c",width:300,render:function(t){return Object(le.jsxs)("span",{children:[Object(le.jsx)(fe,{onClick:function(){e.showUpdate(t)},children:"\u4fee\u6539\u5206\u7c7b"}),"0"===e.state.parentId?Object(le.jsx)(fe,{onClick:function(){return e.showSubCategorys(t)},children:"\u67e5\u770b\u5b50\u5206\u7c7b"}):null]})}}]},e.getCategorys=function(){var t=Object(M.a)(F.a.mark((function t(n){var a,r;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),n=n||e.state.parentId,t.next=4,B(n);case 4:a=t.sent,e.setState({loading:!1}),0===a.status?(r=a.data,"0"===n?e.setState({categorys:r}):e.setState({subCategorys:r})):R.a.error("\u83b7\u53d6\u5206\u7c7b\u5217\u8868\u5931\u8d25");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showSubCategorys=function(t){e.setState({parentId:t._id,parentName:t.name},(function(){e.getCategorys()})),console.log("parentId:",e.state.parentId)},e.showCategorys=function(){e.setState({parentId:"0",parentName:"",subCategorys:[]})},e.handleCancel=function(){e.setState({showStatus:0}),e.form.resetFields()},e.addCategory=function(){e.form.validateFields(function(){var t=Object(M.a)(F.a.mark((function t(n,a){var r,s;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=8;break}return e.setState({showStatus:0}),r=a.parentId,s=a.categoryName,e.form.resetFields(),t.next=6,J(s,r);case 6:0===t.sent.status&&(r===e.state.parentId?e.getCategorys():"0"===r&&e.getCategorys("0"));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},e.updateCategory=function(){console.log("updateCategory"),e.form.validateFields(function(){var t=Object(M.a)(F.a.mark((function t(n,a){var r,s;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=9;break}return e.setState({showStatus:0}),r=e.category._id,s=a.categoryName,e.form.resetFields(),t.next=7,Z({categoryId:r,categoryName:s});case 7:0===t.sent.status&&e.getCategorys();case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},e.showAdd=function(){e.setState({showStatus:1})},e.showUpdate=function(t){e.category=t,e.setState({showStatus:2})},e}return Object(k.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getCategorys()}},{key:"render",value:function(){var e=this,t=this.state,n=t.categorys,a=t.loading,r=t.subCategorys,s=t.parentId,c=t.parentName,i=t.showStatus,o=this.category||{},u="0"===s?"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868":Object(le.jsxs)("span",{children:[Object(le.jsx)(fe,{onClick:this.showCategorys,children:"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868"}),Object(le.jsx)(T.a,{type:"arrow-right",style:{marginRight:10}}),Object(le.jsx)("span",{children:c})]}),l=Object(le.jsxs)(_.a,{type:"primary",onClick:this.showAdd,children:[Object(le.jsx)(T.a,{type:"plus"}),"\u6dfb\u52a0"]});return Object(le.jsxs)(Ce.a,{title:u,extra:l,children:[Object(le.jsx)(Ne.a,{dataSource:"0"===s?n:r,columns:this.columns,bordered:!0,rowKey:"_id",pagination:{defaultPageSize:5,showQuickJumper:!0},loading:a}),Object(le.jsx)(be.a,{title:"\u6dfb\u52a0\u5206\u7c7b",visible:1===i,onOk:this.addCategory,onCancel:this.handleCancel,children:Object(le.jsx)(Te,{categorys:n,parentId:s,setForm:function(t){e.form=t}})}),Object(le.jsx)(be.a,{title:"\u66f4\u65b0\u5206\u7c7b",visible:2===i,onOk:this.updateCategory,onCancel:this.handleCancel,children:Object(le.jsx)(Me,{categoryName:o.name,setForm:function(t){e.form=t}})})]})}}]),n}(a.Component),De=(n(556),n(330)),Re=n(141),Ve=n(166),We=n(96),ze=n(323),Le=n(324),Ke=n.n(Le),qe=n(325),He=n.n(qe),Be=(n(646),function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(e){var a;Object(w.a)(this,n),(a=t.call(this,e)).state={editorState:We.EditorState.createEmpty()},a.getDetail=function(){return Ke()(Object(We.convertToRaw)(a.state.editorState.getCurrentContent()))},a.uploadImageCallBack=function(e){return new Promise((function(t,n){var a=new XMLHttpRequest;a.open("POST","/manage/img/upload");var r=new FormData;r.append("image",e),a.send(r),a.addEventListener("load",(function(){var e=JSON.parse(a.responseText).data.url;t({data:{link:e}})})),a.addEventListener("error",(function(){var e=JSON.parse(a.responseText);n(e)}))}))},a.onEditorStateChange=function(e){a.setState({editorState:e})};var r=a.props.detail;if(r){var s=He()(r);if(s){var c=We.ContentState.createFromBlockArray(s.contentBlocks),i=We.EditorState.createWithContent(c);a.state={editorState:i}}}else a.state={editorState:We.EditorState.createEmpty()};return a}return Object(k.a)(n,[{key:"render",value:function(){var e=this.state.editorState;return Object(le.jsx)(ze.Editor,{editorState:e,editorStyle:{border:"1px solid black",minHeight:200,paddingLeft:10},onEditorStateChange:this.onEditorStateChange,toolbar:{image:{uploadCallback:this.uploadImageCallBack,alt:{present:!0,mandatory:!0}}}})}}]),n}(a.Component)),Je=(n(704),n(329)),Ze="http://localhost:5000/upload/",$e=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(e){var a;Object(w.a)(this,n),(a=t.call(this,e)).state={previewVisible:!1,previewImage:"",fileList:[]},a.getImgs=function(){return a.state.fileList.map((function(e){return e.name}))},a.handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(e){console.log("handlePreview"+e),a.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})},a.handleChange=function(){var e=Object(M.a)(F.a.mark((function e(t){var n,r,s,c,i,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,r=t.fileList,console.log(n.status,r.length),console.log("file",r),console.log("fileList",r),console.log(n===r[r.length-1]),"done"!==n.status){e.next=10;break}0===(s=n.response).status?(R.a.success("\u4e0a\u4f20\u56fe\u7247\u6210\u529f"),c=s.data,i=c.name,o=c.url,(n=r[r.length-1]).name=i,n.url=o):R.a.error("\u4e0a\u4f20\u56fe\u7247\u5931\u8d25"),e.next=15;break;case 10:if("removed"!==n.status){e.next=15;break}return e.next=13,Y(n.name);case 13:0===e.sent.status?R.a.success("\u5220\u9664\u56fe\u7247\u6210\u529f\uff01"):R.a.error("\u5220\u9664\u56fe\u7247\u5931\u8d25\uff01");case 15:a.setState({fileList:r});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var r=[],s=a.props.imgs;return s&&s.length>0&&(r=s.map((function(e,t){return{uid:-t,name:e,status:"done",url:Ze+e}}))),a.state={previewVisible:!1,previewImage:"",fileList:r},a}return Object(k.a)(n,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,n=e.previewImage,a=e.fileList,r=Object(le.jsxs)("div",{children:[Object(le.jsx)(T.a,{type:"plus"}),Object(le.jsx)("div",{className:"ant-upload-text",children:"Upload"})]});return Object(le.jsxs)("div",{children:[Object(le.jsx)(Je.a,{accept:"image/*",action:"/manage/img/upload",name:"image",listType:"picture-card",fileList:a,onPreview:this.handlePreview,onChange:this.handleChange,children:a.length>=8?null:r}),Object(le.jsx)(be.a,{visible:t,footer:null,onCancel:this.handleCancel,children:Object(le.jsx)("img",{alt:"example",style:{width:"100%"},src:n})})]})}}]),n}(r.a.Component),Ge={user:{},product:{}},Qe=A.a.Item,Xe=P.a.TextArea,Ye=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(e){var a;return Object(w.a)(this,n),(a=t.call(this,e)).state={options:[]},a.getCategorys=function(){var e=Object(M.a)(F.a.mark((function e(t){var n,r;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(t);case 2:if(0!==(n=e.sent).status){e.next=10;break}if(r=n.data,"0"!==t){e.next=9;break}a.initOptions(r),e.next=10;break;case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.initOptions=function(){var e=Object(M.a)(F.a.mark((function e(t){var n,r,s,c,i,o,u;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}})),r=Object(Ve.a)(a),s=r.isUpdate,c=r.product,i=c.pCategoryId,!s||"0"===i){e.next=10;break}return e.next=6,a.getCategorys(i);case 6:o=e.sent,u=o.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),n.find((function(e){return e.value===i})).children=u;case 10:a.setState({options:n});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.loadData=function(){var e=Object(M.a)(F.a.mark((function e(t){var n,r,s;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t[t.length-1]).loading=!0,e.next=4,a.getCategorys(n.value);case 4:r=e.sent,n.loading=!1,r&&r.length>0?(s=r.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),n.children=s):n.isLeaf=!0,a.setState({options:Object(Re.a)(a.state.options)});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.validatePrice=function(e,t,n){(t*=1)>0?n():n("\u4ef7\u683c\u662f\u5fc5\u987b\u5927\u4e8e0\u7684\u6570\u503c")},a.submit=function(){a.props.form.validateFields(function(){var e=Object(M.a)(F.a.mark((function e(t,n){var r,s,c,i,o,u,l,d,p;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=12;break}return r=a.pw.current.getImgs(),s=a.editor.current.getDetail(),c=n.name,i=n.desc,o=n.price,1===(u=n.categoryIds).length?(l="0",d=u[0]):(l=u[0],d=u[1]),p={name:c,desc:i,price:o,pCategoryId:l,categoryId:d,imgs:r,detail:s},a.isUpdate&&(p._id=a.product._id),e.next=9,ee(p);case 9:0===e.sent.status?(R.a.success("".concat(a.isUpdate?"\u66f4\u65b0":"\u4fee\u6539","\u5546\u54c1\u6210\u529f")),a.props.history.goBack()):R.a.error("".concat(a.isUpdate?"\u66f4\u65b0":"\u4fee\u6539","\u5546\u54c1\u5931\u8d25")),console.log("submit()\u63d0\u4ea4\u7684\u6570\u636e ",n+"values.desc",n.desc+"values.name",n.name+"values.price",n.price+"values.categoryIds",n.categoryIds+"imgs",r+"detail",s);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},a.pw=r.a.createRef(),a.editor=r.a.createRef(),a}return Object(k.a)(n,[{key:"componentDidMount",value:function(){this.getCategorys("0")}},{key:"UNSAFE_componentWillMount",value:function(){var e=Ge.product;this.isUpdate=!!e._id,this.product=e||{}}},{key:"componentWillUnmount",value:function(){Ge.product={}}},{key:"render",value:function(){var e=this,t=this.isUpdate,n=this.product,a=n.pCategoryId,r=n.categoryId,s=n.imgs,c=n.detail,i=[];t&&("0"===a||i.push(a),i.push(r));var o=this.props.form.getFieldDecorator,u=Object(le.jsxs)("span",{children:[Object(le.jsx)(fe,{onClick:function(){return e.props.history.goBack()},children:Object(le.jsx)(T.a,{type:"arrow-left",style:{fontSize:20}})}),Object(le.jsx)("span",{children:t?"\u4fee\u6539\u5546\u54c1":"\u6dfb\u52a0\u5546\u54c1"})]});return Object(le.jsx)(Ce.a,{title:u,children:Object(le.jsxs)(A.a,Object(l.a)(Object(l.a)({},{labelCol:{span:2},wrapperCol:{span:8}}),{},{children:[Object(le.jsx)(Qe,{label:"\u5546\u54c1\u540d\u79f0",children:o("name",{initialValue:n.name,rules:[{required:!0,message:"\u5546\u54c1\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(Object(le.jsx)(P.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}))}),Object(le.jsx)(Qe,{label:"\u5546\u54c1\u63cf\u8ff0",children:o("desc",{initialValue:n.desc,rules:[{required:!0,message:"\u5546\u54c1\u63cf\u8ff0\u5fc5\u987b\u8f93\u5165"}]})(Object(le.jsx)(Xe,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0",autosize:{minRows:2,maxRows:8}}))}),Object(le.jsx)(Qe,{label:"\u5546\u54c1\u4ef7\u683c",children:o("price",{initialValue:n.price,rules:[{required:!0,message:"\u5546\u54c1\u4ef7\u683c\u5fc5\u987b\u8f93\u5165"},{validator:this.validatePrice}]})(Object(le.jsx)(P.a,{type:"number",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u4ef7\u683c",addonAfter:"\u5143"}))}),Object(le.jsx)(Qe,{label:"\u5546\u54c1\u5206\u7c7b",children:o("categoryIds",{initialValue:i,rules:[{required:!0,message:"\u5546\u54c1\u5206\u7c7b\u5fc5\u987b\u8f93\u5165"}]})(Object(le.jsx)(De.a,{placeholder:"\u8bf7\u6307\u5b9a\u5546\u54c1\u5206\u7c7b",options:this.state.options,loadData:this.loadData}))}),Object(le.jsx)(Qe,{label:"\u5546\u54c1\u56fe\u7247",children:Object(le.jsx)($e,{ref:this.pw,imgs:s})}),Object(le.jsx)(Qe,{label:"\u5546\u54c1\u8be6\u60c5",labelCol:{span:2},wrapperCol:{span:20},children:Object(le.jsx)(Be,{ref:this.editor,detail:c})}),Object(le.jsx)(Qe,{children:Object(le.jsx)(_.a,{type:"primary",onClick:this.submit,children:"\u63d0\u4ea4"})})]}))})}}]),n}(a.PureComponent),et=A.a.create()(Ye),tt=(n(687),n(227)),nt=tt.a.Item,at=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={cName1:"",cName2:""},e}return Object(k.a)(n,[{key:"componentDidMount",value:function(){var e=Object(M.a)(F.a.mark((function e(){var t,n,a,r,s,c,i,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Ge.product,n=t.pCategoryId,a=t.categoryId,"0"!==n){e.next=9;break}return e.next=4,Q(a);case 4:r=e.sent,s=r.data.name,this.setState({cName1:s}),e.next=15;break;case 9:return e.next=11,Promise.all([Q(n),Q(a)]);case 11:c=e.sent,i=c[0].data.name,o=c[1].data.name,this.setState({cName1:i,cName2:o});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){Ge.product={}}},{key:"render",value:function(){var e=this,t=Ge.product,n=t.name,a=t.desc,r=t.price,s=t.detail,c=t.imgs,i=this.state,o=i.cName1,u=i.cName2,l=Object(le.jsxs)("span",{children:[Object(le.jsx)(fe,{children:Object(le.jsx)(T.a,{onClick:function(){return e.props.history.goBack()},type:"arrow-left",style:{fontSize:20,marginRight:10}})}),Object(le.jsx)("span",{children:"\u5546\u54c1\u8be6\u60c5"})]});return Object(le.jsx)(Ce.a,{title:l,className:"product-detail",children:Object(le.jsxs)(tt.a,{children:[Object(le.jsxs)(nt,{children:[Object(le.jsx)("span",{className:"left",children:"\u5546\u54c1\u540d\u79f0\uff1a"}),Object(le.jsx)("span",{children:n})]}),Object(le.jsxs)(nt,{children:[Object(le.jsx)("span",{className:"left",children:"\u5546\u54c1\u63cf\u8ff0\uff1a"}),Object(le.jsx)("span",{children:a})]}),Object(le.jsxs)(nt,{children:[Object(le.jsx)("span",{className:"left",children:"\u5546\u54c1\u4ef7\u683c\uff1a"}),Object(le.jsx)("span",{children:r})]}),Object(le.jsxs)(nt,{children:[Object(le.jsx)("span",{className:"left",children:"\u6240\u5c5e\u5206\u7c7b\uff1a"}),Object(le.jsxs)("span",{children:[o," ",u?" --\x3e "+u:""]})]}),Object(le.jsxs)(nt,{children:[Object(le.jsx)("span",{className:"left",children:"\u5546\u54c1\u56fe\u7247\uff1a"}),Object(le.jsx)("span",{children:c.map((function(e){return Object(le.jsx)("img",{className:"product-img",src:Ze+e,alt:"img"},e)}))})]}),Object(le.jsxs)(nt,{children:[Object(le.jsx)("span",{className:"left",children:"\u5546\u54c1\u8be6\u60c5\uff1a"}),Object(le.jsx)("span",{dangerouslySetInnerHTML:{__html:s}})]}),Object(le.jsx)(nt,{})]})})}}]),n}(a.Component),rt=Ie.a.Option,st=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={products:[],total:0,loading:!1,searchName:"",searchType:"productName"},e.initColumns=function(){e.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name"},{title:"\u5546\u54c1\u63cf\u8ff0",dataIndex:"desc"},{title:"\u4ef7\u683c",dataIndex:"price",render:function(e){return"\xa5"+e}},{width:100,title:"\u72b6\u6001",render:function(t){var n=t.status,a=t._id,r=1===n?2:1;return Object(le.jsxs)("span",{children:[Object(le.jsx)(_.a,{type:"primary",onClick:function(){return e.updateStatus(a,r)},children:1===n?"\u4e0b\u67b6":"\u4e0a\u67b6"}),Object(le.jsx)("span",{children:1===n?"\u5728\u552e":"\u5df2\u4e0b\u67b6"})]})}},{width:100,title:"\u64cd\u4f5c",render:function(t){return Object(le.jsxs)("span",{children:[Object(le.jsx)(fe,{onClick:function(){return e.showDetail(t)},children:"\u8be6\u60c5"}),Object(le.jsx)(fe,{onClick:function(){return e.showUpdate(t)},children:"\u4fee\u6539"})]})}}]},e.showDetail=function(t){Ge.product=t,e.props.history.push("/product/detail")},e.showUpdate=function(t){Ge.product=t,e.props.history.push("/product/addupdate")},e.getProducts=function(){var t=Object(M.a)(F.a.mark((function t(n){var a,r,s,c,i,o,u;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.pageNum=n,e.setState({loading:!0}),a=e.state,r=a.searchName,s=a.searchType,!r){t.next=9;break}return t.next=6,G({pageNum:n,pageSize:2,searchName:r,searchType:s});case 6:c=t.sent,t.next=12;break;case 9:return t.next=11,$(n,2);case 11:c=t.sent;case 12:e.setState({loading:!1}),0===c.status&&(i=c.data,o=i.total,u=i.list,e.setState({total:o,products:u}));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.updateStatus=function(){var t=Object(M.a)(F.a.mark((function t(n,a){return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X(n,a);case 2:0===t.sent.status&&(R.a.success("\u5546\u54c1\u72b6\u6001\u66f4\u65b0\u6210\u529f"),e.getProducts(e.pageNum));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(k.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getProducts(1)}},{key:"render",value:function(){var e=this,t=this.state,n=t.products,a=t.total,r=t.loading,s=t.searchName,c=t.searchType,i=Object(le.jsxs)("span",{children:[Object(le.jsxs)(Ie.a,{value:c,style:{width:150},onChange:function(t){return e.setState({searchType:t})},children:[Object(le.jsx)(rt,{value:"productName",children:"\u6309\u540d\u79f0\u641c\u7d22"}),Object(le.jsx)(rt,{value:"productDesc",children:"\u6309\u63cf\u8ff0\u641c\u7d22"})]}),Object(le.jsx)(P.a,{placeholder:"\u5173\u952e\u5b57",style:{width:150,margin:"0 15px"},value:s,onChange:function(t){return e.setState({searchName:t.target.value})}}),Object(le.jsx)(_.a,{type:"primary",onClick:function(){return e.getProducts(1)},children:"\u641c\u7d22"})]}),o=Object(le.jsxs)(_.a,{type:"primary",onClick:function(){return e.props.history.push("/product/addupdate")},children:[Object(le.jsx)(T.a,{type:"plus"}),"\u6dfb\u52a0\u5546\u54c1"]});return Object(le.jsxs)(Ce.a,{title:i,extra:o,children:[Object(le.jsx)(Ne.a,{loading:r,bordered:!0,rowKey:"_id",dataSource:n,columns:this.columns,pagination:{current:this.pageNum,total:a,defaultPageSize:2,showQuickJumper:!0,onChange:this.getProducts}}),";"]})}}]),n}(a.Component),ct=(n(689),function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"render",value:function(){return Object(le.jsxs)(I.d,{children:[Object(le.jsx)(I.b,{path:"/product",component:st,exact:!0}),Object(le.jsx)(I.b,{path:"/product/addupdate",component:et}),Object(le.jsx)(I.b,{path:"/product/detail",component:at}),Object(le.jsx)(I.a,{to:"/product"})]})}}]),n}(a.Component)),it=A.a.Item,ot=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return Object(le.jsx)(A.a,Object(l.a)(Object(l.a)({},{labelCol:{span:5},wrapperCol:{span:15}}),{},{children:Object(le.jsx)(it,{label:"\u89d2\u8272\u540d\u79f0",children:e("roleName",{initialValue:"",rules:[{required:!0,message:"\u89d2\u8272\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(Object(le.jsx)(P.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"}))})}))}}]),n}(a.Component),ut=A.a.create()(ot),lt=(n(690),n(226)),dt=A.a.Item,pt=lt.a.TreeNode,ht=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(e){var a;Object(w.a)(this,n),(a=t.call(this,e)).getTreeNodes=function(e){return e.reduce((function(e,t){return e.push(Object(le.jsx)(pt,{title:t.title,children:t.children?a.getTreeNodes(t.children):null},t.key)),e}),[])},a.getMenus=function(){return a.state.checkedKeys},a.onCheck=function(e){console.log("onCheck",e),a.setState({checkedKeys:e})};var r=a.props.role.menus;return a.state={checkedKeys:r},a}return Object(k.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.treeNodes=this.getTreeNodes(me)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){console.log("UNSAFE_componentWillReceiveProps",e);var t=e.role.menus;this.setState({checkedKeys:t})}},{key:"render",value:function(){console.log("render() authform");var e=this.props.role,t=this.state.checkedKeys;return Object(le.jsxs)("div",{children:[Object(le.jsx)(dt,Object(l.a)(Object(l.a)({label:"\u89d2\u8272\u540d\u79f0"},{labelCol:{span:5},wrapperCol:{span:15}}),{},{children:Object(le.jsx)(P.a,{value:e.name,disabled:!0})})),Object(le.jsx)(lt.a,{checkable:!0,defaultExpandAll:!0,checkedKeys:t,onCheck:this.onCheck,children:Object(le.jsx)(pt,{title:"\u5e73\u53f0\u6743\u9650",children:this.treeNodes},"all")})]})}}]),n}(a.PureComponent),jt=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(e){var a;return Object(w.a)(this,n),(a=t.call(this,e)).state={roles:[],role:{},isShowAdd:!1,isShowAuth:!1},a.OnRow=function(e){return{onClick:function(t){console.log("role onClick",e),a.setState({role:e})}}},a.initColumn=function(){a.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:function(e){return Oe(e)}},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:Oe},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"}]},a.getRoles=Object(M.a)(F.a.mark((function e(){var t,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q("api/manage/role/list");case 2:0===(t=e.sent).status&&(n=t.data,a.setState({roles:n}));case 4:case"end":return e.stop()}}),e)}))),a.addRole=function(){a.form.validateFields(function(){var e=Object(M.a)(F.a.mark((function e(t,n){var r,s,c;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}return a.setState({isShowAdd:!1}),r=n.roleName,a.form.resetFields(),e.next=6,te(r);case 6:0===(s=e.sent).status?(R.a.success("\u89d2\u8272\u6dfb\u52a0\u6210\u529f"),c=s.data,a.setState((function(e){return{roles:[].concat(Object(Re.a)(e.roles),[c])}}))):R.a.error("\u89d2\u8272\u6dfb\u52a0\u5931\u8d25");case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},a.updateRole=Object(M.a)(F.a.mark((function e(){var t,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({isShowAuth:!1}),t=a.state.role,n=a.auth.current.getMenus(),t.menus=n,t.auth_name=a.props.user.username,t.auth_time=Date.now(),e.next=8,ne(t);case 8:0===e.sent.status&&(t._id===a.props.user.role_id?(a.props.logout(),R.a.warning("\u5f53\u524d\u89d2\u8272\u6743\u9650\u5df2\u7ecf\u4fee\u6539\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55")):(R.a.success("\u8bbe\u7f6e\u89d2\u8272\u6743\u9650\u6210\u529f"),a.setState({roles:Object(Re.a)(a.state.roles)})));case 10:case"end":return e.stop()}}),e)}))),a.auth=r.a.createRef(),a}return Object(k.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.initColumn()}},{key:"componentDidMount",value:function(){this.getRoles()}},{key:"render",value:function(){var e=this,t=this.state,n=t.roles,a=t.role,r=t.isShowAdd,s=t.isShowAuth,c=Object(le.jsxs)("span",{children:[Object(le.jsx)(_.a,{type:"primary",onClick:function(){return e.setState({isShowAdd:!0})},children:"\u521b\u5efa\u89d2\u8272"}),"\xa0\xa0",Object(le.jsx)(_.a,{type:"primary",disabled:!a._id,onClick:function(){return e.setState({isShowAuth:!0})},children:"\u8bbe\u7f6e\u521b\u5efa\u89d2\u8272"})]});return Object(le.jsxs)(Ce.a,{title:c,children:[Object(le.jsx)(Ne.a,{dataSource:n,columns:this.columns,bordered:!0,rowKey:"_id",pagination:{defaultPageSize:2,showQuickJumper:!0},rowSelection:{type:"radio",selectedRowKeys:[a._id],onSelect:function(t){e.setState({role:t})}},onRow:this.OnRow}),Object(le.jsx)(be.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:r,onOk:this.addRole,onCancel:function(){e.setState({isShowAdd:!1})},children:Object(le.jsx)(ut,{setForm:function(t){e.form=t}})}),Object(le.jsx)(be.a,{title:"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650",visible:s,onOk:this.updateRole,onCancel:function(){e.setState({isShowAuth:!1})},children:Object(le.jsx)(ht,{role:a,ref:this.auth})})]})}}]),n}(a.Component),bt=Object(D.b)((function(e){return{user:e.user}}),{logout:ue})(jt),ft=A.a.Item,mt=Ie.a.Option,Ot=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).validatePwd=function(e,t,n){t.length<4?n("\u5bc6\u7801\u5fc5\u987b\u4e0d\u80fd\u5c0f\u4e8e4\u4f4d"):t.length>12?n("\u5bc6\u7801\u5fc5\u987b\u4e0d\u80fd\u5927\u4e8e12\u4f4d"):/^[a-zA-Z0-9_]+$/.test(t)?n():n("\u5bc6\u7801\u5fc5\u987b\u4e3a\u82f1\u6587\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210")},e.validatePhone=function(e,t,n){/^1[3-9][0-9]{9}$/.test(t)?n():n("\u624b\u673a\u53f7\u4e0d\u7b26\u5408\u89c4\u8303")},e.validateEmail=function(e,t,n){/^[A-Za-z0-9._%-]+@([A-Za-z0-9-]+\.)+[A-Za-z]{2,4}$/.test(t)?n():n("\u90ae\u7bb1\u4e0d\u7b26\u5408\u89c4\u8303")},e}return Object(k.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props,t=e.roles,n=e.user,a=this.props.form.getFieldDecorator;return Object(le.jsxs)(A.a,Object(l.a)(Object(l.a)({},{labelCol:{span:4},wrapperCol:{span:15}}),{},{children:[Object(le.jsx)(ft,{label:"\u7528\u6237\u540d",children:a("username",{rules:[{required:!0,whitespace:!0,message:"\u7528\u6237\u540d\u5fc5\u987b\u8f93\u5165"},{min:4,message:"\u7528\u6237\u540d\u5fc5\u987b\u5927\u4e8e4\u4f4d"},{max:12,message:"\u7528\u6237\u540d\u5fc5\u987b\u5c0f\u4e8e12\u4f4d"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u4e3a\u82f1\u6587\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210"}],initialValue:n.username})(Object(le.jsx)(P.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",autoComplete:"off"}))}),n._id?null:Object(le.jsx)(ft,{label:"\u5bc6\u7801",children:a("password",{rules:[{required:!0,whitespace:!0,message:"\u5bc6\u7801\u5fc5\u987b\u8f93\u5165"},{validator:this.validatePwd}],initialValue:n.password})(Object(le.jsx)(P.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"}))}),Object(le.jsx)(ft,{label:"\u624b\u673a\u53f7",children:a("phone",{rules:[{required:!0,whitespace:!0,message:"\u624b\u673a\u53f7\u5fc5\u987b\u8f93\u5165"},{validator:this.validatePhone}],initialValue:n.phone})(Object(le.jsx)(P.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7",autoComplete:"off"}))}),Object(le.jsx)(ft,{label:"\u90ae\u7bb1",children:a("email",{rules:[{required:!0,whitespace:!0,message:"\u90ae\u7bb1\u5fc5\u987b\u8f93\u5165"},{validator:this.validateEmail}],initialValue:n.email})(Object(le.jsx)(P.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1",autoComplete:"off"}))}),Object(le.jsx)(ft,{label:"\u89d2\u8272",children:a("role_id",{rules:[{required:!0,message:"\u89d2\u8272\u7c7b\u578b\u5fc5\u987b\u9009\u62e9"}],initialValue:n.role_id})(Object(le.jsx)(Ie.a,{children:t.map((function(e){return Object(le.jsx)(mt,{value:e._id,children:e.name},e._id)}))}))})]}))}}]),n}(a.Component),gt=A.a.create()(Ot),xt=be.a.confirm,vt=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={isShow:!1,users:[],roles:[]},e.initColumns=function(){e.columns=[{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u7535\u8bdd",dataIndex:"phone"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"create_time",render:Oe},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"role_id",render:function(t){return e.roleNames[t]}},{title:"\u64cd\u4f5c",render:function(t){return Object(le.jsxs)("span",{children:[Object(le.jsx)(fe,{onClick:function(){return e.showUpdate(t)},children:"\u4fee\u6539"}),Object(le.jsx)(fe,{onClick:function(){return e.deleteUser(t)},children:"\u5220\u9664"})]})}}]},e.initRoleNames=function(t){var n=t.reduce((function(e,t){return e[t._id]=t.name,e}),{});e.roleNames=n},e.getUsers=Object(M.a)(F.a.mark((function t(){var n,a,r,s;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ae();case 2:0===(n=t.sent).status&&(a=n.data,r=a.users,s=a.roles,e.initRoleNames(s),e.setState({users:r,roles:s}));case 4:case"end":return t.stop()}}),t)}))),e.deleteUser=function(t){console.log("user",t),xt({title:"\u4f60\u60f3\u8981\u5220\u9664".concat(t.username,"\u5417\uff1f"),onOk:function(){var n=Object(M.a)(F.a.mark((function n(){return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,re(t._id);case 2:0===n.sent.status?(R.a.success("\u5220\u9664\u7528\u6237".concat(t.username,"\u6210\u529f\uff01")),e.getUsers()):R.a.error("\u5220\u9664\u7528\u6237\u5931\u8d25\uff01");case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()})},e.addOrUpdateUser=function(){e.form.validateFields(function(){var t=Object(M.a)(F.a.mark((function t(n,a){var r;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=10;break}return console.log("Received values of form: ",a),e.setState({isShow:!1}),r=e.form.getFieldsValue(),e.form.resetFields(),e.user&&(r._id=e.user._id),t.next=8,se(r);case 8:0===t.sent.status&&(R.a.success("".concat(e.user?"\u4fee\u6539":"\u6dfb\u52a0","\u7528\u6237\u6210\u529f\uff01")),e.getUsers());case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},e.showUpdate=function(t){e.user=t,e.setState({isShow:!0})},e.showAdd=function(){e.user=null,e.setState({isShow:!0})},e}return Object(k.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getUsers()}},{key:"render",value:function(){var e=this,t=this.state,n=t.isShow,a=t.users,r=t.roles,s=this.user||{},c=Object(le.jsx)(_.a,{type:"primary",onClick:this.showAdd,children:"\u521b\u5efa\u7528\u6237"});return Object(le.jsxs)(Ce.a,{title:c,children:[Object(le.jsx)(Ne.a,{dataSource:a,columns:this.columns,bordered:!0,rowKey:"_id",pagination:{defaultPageSize:2}}),Object(le.jsx)(be.a,{title:s._id?"\u4fee\u6539\u7528\u6237":"\u6dfb\u52a0\u7528\u6237",visible:n,onOk:this.addOrUpdateUser,onCancel:function(){e.form.resetFields(),e.setState({isShow:!1})},children:Object(le.jsx)(gt,{setForm:function(t){return e.form=t},roles:r,user:s})})]})}}]),n}(a.Component),yt=n(112),wt=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={sales:[5,20,36,10,10,20],stores:[6,10,25,20,15,10]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.reduce((function(e,t){return e.push(t-1),e}),[])}}))},e.getOption=function(e,t){return{title:{text:"ECharts \u5165\u95e8\u793a\u4f8b"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"bar",data:e},{name:"\u5e93\u5b58",type:"bar",data:t}]}},e}return Object(k.a)(n,[{key:"render",value:function(){var e=this.state,t=e.sales,n=e.stores;return Object(le.jsxs)("div",{children:[Object(le.jsx)(Ce.a,{children:Object(le.jsx)(_.a,{type:"primary",onClick:this.update,children:"\u66f4\u65b0"})}),Object(le.jsx)(Ce.a,{title:"\u67f1\u72b6\u56fe\u4e00",children:Object(le.jsx)(yt.a,{option:this.getOption(t,n)})})]})}}]),n}(a.Component),kt=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={sales:[5,20,36,10,10,20],stores:[6,10,25,20,15,10]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.reduce((function(e,t){return e.push(t-1),e}),[])}}))},e.getOption=function(e,t){return{title:{text:"ECharts \u5165\u95e8\u793a\u4f8b"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"line",data:e},{name:"\u5e93\u5b58",type:"line",data:t}]}},e}return Object(k.a)(n,[{key:"render",value:function(){var e=this.state,t=e.sales,n=e.stores;return Object(le.jsxs)("div",{children:[Object(le.jsx)(Ce.a,{children:Object(le.jsx)(_.a,{type:"primary",onClick:this.update,children:"\u66f4\u65b0"})}),Object(le.jsx)(Ce.a,{title:"\u6298\u7ebf\u56fe\u4e00",children:Object(le.jsx)(yt.a,{option:this.getOption(t,n)})})]})}}]),n}(a.Component),St=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).getOption=function(){return{title:{text:"\u67d0\u7ad9\u70b9\u7528\u6237\u8bbf\u95ee\u6765\u6e90",subtext:"\u7eaf\u5c5e\u865a\u6784",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["\u76f4\u63a5\u8bbf\u95ee","\u90ae\u4ef6\u8425\u9500","\u8054\u76df\u5e7f\u544a","\u89c6\u9891\u5e7f\u544a","\u641c\u7d22\u5f15\u64ce"]},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:234,name:"\u8054\u76df\u5e7f\u544a"},{value:135,name:"\u89c6\u9891\u5e7f\u544a"},{value:1548,name:"\u641c\u7d22\u5f15\u64ce"}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},e.getOption2=function(){return{backgroundColor:"#2c343c",title:{text:"Customized Pie",left:"center",top:20,textStyle:{color:"#ccc"}},tooltip:{trigger:"item"},visualMap:{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","50%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:274,name:"\u8054\u76df\u5e7f\u544a"},{value:235,name:"\u89c6\u9891\u5e7f\u544a"},{value:400,name:"\u641c\u7d22\u5f15\u64ce"}].sort((function(e,t){return e.value-t.value})),roseType:"radius",label:{color:"rgba(255, 255, 255, 0.3)"},labelLine:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"},smooth:.2,length:10,length2:20},itemStyle:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()}}]}},e}return Object(k.a)(n,[{key:"render",value:function(){return Object(le.jsxs)("div",{children:[Object(le.jsx)(Ce.a,{title:"\u997c\u72b6\u56fe\u4e00",children:Object(le.jsx)(yt.a,{option:this.getOption(),style:{height:300}})}),Object(le.jsx)(Ce.a,{title:"\u997c\u72b6\u56fe\u4e8c",children:Object(le.jsx)(yt.a,{option:this.getOption2(),style:{height:300}})})]})}}]),n}(a.Component),Ct=(n(701),function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"render",value:function(){return Object(le.jsx)("div",{className:"order",children:"\u8ba2\u5355\u7ba1\u7406\u6a21\u5757\u5b66\u751f\u5b9e\u6218\u5f00\u53d1\u4e2d..."})}}]),n}(a.Component)),Nt=(n(259),n(97)),It=(n(260),n(57)),_t=(n(702),function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){var e;Object(w.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).goHome=function(){e.props.setHeadTitle("\u9996\u9875"),e.props.history.replace("/home")},e}return Object(k.a)(n,[{key:"render",value:function(){return Object(le.jsxs)(Nt.a,{className:"not-found",children:[Object(le.jsx)(It.a,{span:12,className:"left"}),Object(le.jsxs)(It.a,{span:12,className:"right",children:[Object(le.jsx)("h1",{children:"404"}),Object(le.jsx)("h2",{children:"\u62b1\u6b49\uff0c\u4f60\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728"}),Object(le.jsx)("div",{children:Object(le.jsx)(_.a,{type:"primary",onClick:this.goHome,children:"\u56de\u5230\u9996\u9875"})})]})]})}}]),n}(a.Component)),At=Object(D.b)(null,{setHeadTitle:ie})(_t),Pt=je.a.Footer,Tt=je.a.Sider,Ut=je.a.Content,Ft=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"render",value:function(){var e=this.props.user;return e&&e._id?Object(le.jsxs)(je.a,{style:{minHeight:"100%"},children:[Object(le.jsx)(Tt,{children:Object(le.jsx)(ke,{})}),Object(le.jsxs)(je.a,{children:[Object(le.jsx)(xe,{children:"Header"}),Object(le.jsx)(Ut,{style:{margin:20,backgroundColor:"#fff"},children:Object(le.jsxs)(I.d,{children:[Object(le.jsx)(I.a,{from:"/",to:"/home",exact:!0}),Object(le.jsx)(I.b,{path:"/home",component:Se}),Object(le.jsx)(I.b,{path:"/category",component:Ee}),Object(le.jsx)(I.b,{path:"/product",component:ct}),Object(le.jsx)(I.b,{path:"/role",component:bt}),Object(le.jsx)(I.b,{path:"/user",component:vt}),Object(le.jsx)(I.b,{path:"/charts/bar",component:wt}),Object(le.jsx)(I.b,{path:"/charts/line",component:kt}),Object(le.jsx)(I.b,{path:"/charts/pie",component:St}),Object(le.jsx)(I.b,{path:"/order",component:Ct}),Object(le.jsx)(I.b,{component:At})]})}),Object(le.jsx)(Pt,{style:{textAlign:"center",color:"#aaaaaa"},children:"\u63a8\u8350\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668\uff0c \u53ef\u4ee5\u83b7\u5f97\u66f4\u4f73\u9875\u9762\u64cd\u4f5c\u4f53\u9a8c"})]})]}):Object(le.jsx)(I.a,{to:"/login"})}}]),n}(a.Component),Mt=Object(D.b)((function(e){return{user:e.user}}),{})(Ft),Et=function(e){Object(S.a)(n,e);var t=Object(C.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"render",value:function(){return Object(le.jsx)(N.a,{children:Object(le.jsxs)(I.d,{children:[Object(le.jsx)(I.b,{path:"/login",component:he}),Object(le.jsx)(I.b,{path:"/",component:Mt})]})})}}]),n}(a.Component),Dt=Et;c.a.render(Object(le.jsx)(D.a,{store:y,children:Object(le.jsx)(Dt,{})}),document.getElementById("root"))}},[[703,1,2]]]);
//# sourceMappingURL=main.756d3c77.chunk.js.map